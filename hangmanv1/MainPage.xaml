<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="hangmanv1.MainPage">

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="12" RowSpacing="10">

        <!-- Category Selection -->
        <HorizontalStackLayout Grid.Row="0" Spacing="10" HorizontalOptions="Center">
            <Label Text="Category:" VerticalOptions="Center" FontSize="16"/>
            <Picker
                Title="Select Category"
                ItemsSource="{Binding Categories}"
                SelectedItem="{Binding SelectedCategory}"
                WidthRequest="200"
                HeightRequest="40" />
        </HorizontalStackLayout>

        <!-- Header -->
        <VerticalStackLayout Grid.Row="1" Spacing="6" HorizontalOptions="Center">
            <Label
                Text="{Binding GameStatus}"
                FontAttributes="Bold"
                FontSize="20"
                HorizontalOptions="Center" />

            <Label
                Text="{Binding Message}"
                FontSize="17"
                HorizontalOptions="Center" />

            <Label
                Text="{Binding LettersNeededText}"
                FontSize="14"
                HorizontalOptions="Center" />
        </VerticalStackLayout>

        <!-- Main: image + spotlight -->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>


            <!-- Hangman image (frames + animated gif on lose) -->
            <Image Source="{Binding CurrentImage}" 
                   Aspect="AspectFit" 
                   HeightRequest="300" 
                   WidthRequest="300"/>

            <!-- Spotlight (word with underscores) -->
            <Label
                Grid.Row="1"
                Text="{Binding Spotlight}"
                FontSize="36"
                HorizontalOptions="Center"
                VerticalOptions="Center"
                Margin="0,12,0,0" />
        </Grid>

        <!-- Letters area: image buttons produced from Letters collection -->
        <ScrollView Grid.Row="3" HeightRequest="210">
            <FlexLayout
                x:Name="LettersContainer"
                BindableLayout.ItemsSource="{Binding Letters}"
                Wrap="Wrap"
                JustifyContent="SpaceEvenly"
                AlignItems="Center"
                Padding="6"
                Direction="Row">

                <BindableLayout.ItemTemplate>
                    <DataTemplate>
                        <VerticalStackLayout Spacing="4" HorizontalOptions="Center">
                            <ImageButton
                                Source="{Binding ImagePath}"
                                HeightRequest="68"
                                WidthRequest="68"
                                BackgroundColor="Transparent"
                                Clicked="LetterImageButton_Clicked"
                                CommandParameter="{Binding Key}"
                                IsEnabled="{Binding IsEnabled}" />

                        </VerticalStackLayout>
                    </DataTemplate>
                </BindableLayout.ItemTemplate>

            </FlexLayout>
        </ScrollView>

        <!-- Reset button overlay bottom-right -->
        <Button
            Text="Reset"
            WidthRequest="110"
            HeightRequest="40"
            HorizontalOptions="End"
            VerticalOptions="End"
            Margin="0,6,0,0"
            Clicked="Reset_Clicked"
            Grid.Row="3" />

    </Grid>

</ContentPage>
